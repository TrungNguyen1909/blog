#include<stdio.h>
#include<stdbool.h>  
#include<stdlib.h>   
#include<string.h>   	     
#include<sys/types.h>   			 	 
   		  	  
int PASSWORD = 42;			  	 
   		 				
   			 			
unsigned int get_password() {			  		
   	unsigned	int	input;  		
   	printf("password:	");    	
   	scanf("%d",	&input);	    

 		 return input;       	   		     		  				    		
}   		  	  
	
		
bool check_password(int password)	{		
   	return password	== PASSWORD; 		
}   	 	    
		    	 	    
   	 	   	
void	xorstr(int	*s1, int *s2, int *dest)	{ 	  		
	for	(size_t	i = 0; i	< 24; i++)	{
   		dest[i] = s1[i]	^ s2[i]; 
	}				    	 	
}	      		   		
		 
  	   
void get_flag(int *flag) {	  	
	static	int	vectors[100][24] = { 	 

 	{124,	95,	63,	86,	10, 74,	71, 39, 84, 117, 70,	116, 51,	
104, 112, 61, 33,	9, 87, 92,	
40,	118,	120,	96},   	 

 	{72,	32,	54,	76, 101,	91, 118, 123,	71,	59,	109,	83, 116, 
37,	120, 121, 
94, 112, 42, 117,	58, 
110, 79, 46}, 		 

 	{86,	87,	72,	69,	90,	93,	11,	61,	84, 36,	108,	115,	119,	
91,	66, 54, 83,	
51,	112, 95,	75, 9, 64,	105}, 	

 
	{126, 107, 34,	105,	95, 

69, 32, 35,	67, 38, 108,	103, 50,	
99, 122, 86, 
84, 81, 121, 106,	77, 82,	68, 12},
  {56, 33,	73,	104,	99,	81,	110, 118,	
83, 95, 120, 58,	108,	84, 78,	88, 106,	
94, 125, 68, 126,	72,	69, 96},  	 
  {118, 71,	38, 9, 47, 108, 64, 93,	
40, 110, 63, 120,	90,	54,	114, 61,	55, 32, 
34, 78, 115, 73,	56, 83},			  
  {72, 69,	111, 47, 54, 41,	86, 62, 
99, 51, 44, 75,	106,	32, 119,	109,	104,	114, 
78, 56, 98, 33,	45, 97},    	
  {79, 95,	91, 99, 68, 63, 97, 
42, 53, 122, 100,	66, 36,	110, 73, 55,	32,	
74, 48, 108, 59,	69,	64, 43}, 		
  {39, 49,	35,	46, 34, 123, 119,	102,	
37, 10, 108, 69,	86,	57, 72,	83, 55, 
41, 54, 33, 97,	122, 107,	90},    
  {99, 69,	66,	41,	59, 77, 58,	124,	
70, 125, 94, 88,	68,	107,	78,	53, 71,	108,	
85, 89, 91, 34,	47, 92},  		 
  {122, 60,	106, 43,	98, 59,	107, 124, 
48, 89, 99, 110,	50, 82, 70, 125, 73,	44,	
103, 84, 46, 64,	33,	90},	 	  
  {33, 84,	10,	81,	72, 114, 62,	40,	
37, 116, 11, 96,	110,	121, 48, 44,	75, 98,	
69, 47, 108, 124,	97,	38},  		 
  {41, 111,	54,	125, 10, 39,	67, 113,	
42, 36, 32, 43,	121,	101, 85, 34,	76, 59, 
68, 122, 126, 91,	55,	106}, 				
  {91, 35,	96, 75, 51, 94, 111,	56,	

36, 76,	117,	41, 57, 85, 126, 114, 33, 49, 61, 124, 84,	83, 81, 48}, 		     		  				    		

 
	{33, 101, 91,	109,	80,	

95, 114, 10,	108, 50, 88,	122,	38, 
46, 48, 83, 
107, 110, 104, 44,	51, 102,	52, 98},
  {68, 99,	41, 37, 53, 122, 66,	
101, 81, 126, 105,	71, 114, 69,	
46, 119, 95, 67,	65,	89, 96, 123,	51, 56}, 
  {36, 38,	94,	34,	57, 75, 121,	65, 
86, 67, 73, 13,	111,	125, 54,	78,	89,	32,	
50, 96, 56, 52,	42,	72},	 			
  {99, 8,	41,	125,	109, 7, 33,	85,	
96, 106, 15, 35,	55, 44, 87, 64, 45, 
100, 59, 57, 55,	113,	106,	12},  		
  {40, 126,	77,	46, 86, 102, 73, 79,	
59, 66, 97, 50,	36,	110,	120, 112, 11, 34, 
88, 106, 45, 114,	70, 72}, 	
  {56, 104,	51,	121, 55, 86,	34,	100,	
45, 67, 44, 105,	12, 94, 42, 96, 110, 
88, 65, 39, 75,	33,	48, 123},			 
  {85, 52,	114, 53, 77, 46, 102, 
87, 36, 55, 113,	106,	100, 115,	39,	49,	121,	
11, 32, 70, 67,	104,	64,	119},  	 
  {100, 9,	77,	36,	124, 43,	115,	52,	

66, 117,	53,	88, 74, 114, 49, 95, 104, 103, 119, 87, 97,	109, 60, 69}, 		     		  				    		

  {9,	12, 55, 80,	109,	47,	
96, 114, 62, 107,	33, 42, 112,	97,	65, 
88, 50, 73, 66,	10, 69,	118,	86, 39}, 	
		{33, 77, 43, 51, 42,	63, 54, 67, 101,	55, 61,	
100, 62, 41, 66,	78, 113,	112, 9,	40, 
58,	93,	95, 32},   		 			   
  {35, 44,	53,	107, 71,	64, 102, 57,	9, 56, 
69,	95,	112, 



78, 103, 97,	125,	67,	39,	13,	124,	72,	66,	113}, 				
  {110, 51,	

92, 56, 66,	112, 116,	43, 
101, 64,	75, 36, 32,	

63,	80,	76,	117, 49,	96,	
77, 58,	104, 105, 108},	

	 {62,	59,	102, 89, 
35, 42,	94, 92, 87,	83, 
120,	58, 103, 
57, 
77,	64, 45, 84, 36,	
99,	54, 121, 63,	104}, 
	
 
{78,	76, 44,	39, 

46, 73, 126,	56, 104,	33,	
110, 

87, 53, 121, 

54, 74, 116,	52,	99, 120, 
72, 117,	
81, 66},	 

	

 {66, 89,	67,	117, 47,	75,	88,	100,	98, 96, 50, 36, 10,	42,	
37, 
33, 
71,	91,	81,	90,	84,	97, 

99, 114},
		{97,	42,	

70, 48, 111,	76,	75,	122, 
92, 50, 9,	49,	
118,	84, 13, 

54, 91, 124,	33,	93,	80,	

121,	

51, 46}, 				 		      
 
 {62, 63,	56, 103, 80,	86, 
111,	58, 53, 46,	
52,	33,	72,	125, 64, 48, 96,	
68, 97,	
38, 59,	

106, 
121,	113},  	 

  {56,	96, 48, 13, 84,	
60, 


116, 52, 51,	103, 124, 93,	67, 

59,	

9, 119, 62,	47,	118,	34,	32, 54,	65,	123},		 		 
 
 {90, 88,	89, 116, 33,	51, 
75,	98, 104, 34,	
44,	94,	87,	86, 79,	115, 123, 
105, 


76, 
54,	102, 63,	92, 53},	

  {109,	53, 73,	74, 32, 
11, 56,	
108, 35,	

69, 100, 43,	96, 57,	103, 81,	

89,	

38, 60, 119,	50, 76, 112, 120},   					  		 
 
 
{40,	42, 41,	125, 81,	53,	100,	

48,	93,	77,	122,	72, 126, 67, 
85, 83, 102, 74,	

79, 
49,	117,	98, 105, 112},	

  {52,	124, 73,	10,	54,	
105, 79, 101, 

108, 
92,	117,	103, 104, 36,	

60, 78, 82,	98,	33, 118, 90, 
102, 35, 75},		

  {103,	10,	123, 74, 106,	

43,	

98, 75, 118,	58,	124,	52, 105,	67, 45, 96,	48,	114,	46,	109, 81, 
54, 
12, 107},
	 {63,	61,	125, 56,	103,	
92, 
66,	81, 58,	99, 100, 118,	
78,	73, 84,	94,	
97, 
91,	102,	69,	120, 113,	40, 59}, 				  

  {10,	93,	105, 58,	103,	
83, 


78,	

117, 96, 11,	98,	76,	118,	101, 88,	100, 54, 111, 64, 12,	95, 52,	
43, 60},
  {11,	82, 68, 117,	13, 
116,	52, 78, 

67, 54,	107,	50,	87, 55,	100,	91,	86,	70, 76, 41, 12, 43,	84,	122},
 	{69, 65, 37,	
94, 100,	125, 41, 111,	97,	

118, 102,	75,	92,	40,	85, 81,	68, 67, 35,	11,	90,	82,	96, 113}, 
	 {75,	34, 90, 114,	
65, 61,	123, 

86,	

39, 58, 49,	78, 81, 12, 100, 63, 70,	13,	59, 112, 67,	69, 77, 33}, 	  
 
 
{47,	46, 110,	82,	113,	78,	105, 
55, 
67, 109, 80, 38, 49,	
11,	94, 73, 57,	
32,	62, 63,	33,	79,	45,	76}, 

 
	{84,	49,	35,	116,	

105, 110, 100,	96,	52,	48,	64, 

34,	

78, 113, 38,	39,	66,	121,	12,	
126, 57, 108, 
85, 62},	  	

  {84,	114, 64, 110, 100, 35, 
33, 
65, 53, 90,	75, 10, 58,	69, 
99,	71, 47, 77,	92, 
121, 68,	118, 51, 94},
  {124, 80,	
83,	115, 110, 109,	
71,	121, 112,	85, 55, 78, 11, 91,	
64, 
53, 51, 33,	113, 69, 63,	60, 
93,	67},      	 
	 {121,	35, 103, 
70, 42, 
58, 55,	37, 123, 
52, 94,	109, 63, 77,	59, 117, 
112, 
113,	85,	38, 69, 99,	115, 95},
 
	{92, 35,	122, 87, 53, 125,	62, 

103,	72,	81,	43, 67, 91, 96,	113,	
48, 

111, 
75,	80, 46,	98, 105, 39,	104},
	 {40, 75, 37, 101, 65, 115,	9, 
67,	88, 123,	69, 64, 
57,	
54, 
43,	60, 116, 36,	34, 49, 

61, 108, 97,	124},   		
 	
{94, 114,	

35, 
44,	76, 70, 122, 67, 101, 

9, 53, 126,	41, 77, 88,	11, 43, 

118, 
106,	56, 33, 81, 123, 63}, 

  {42,	36, 49, 96, 82,	57, 
94, 

125, 58,	
104, 61,	93,	

68,	

111, 81, 98,	56, 46, 107, 13, 84,	
108, 

116, 70},	
 	

{53,	




38, 68, 72,	125, 111, 44, 48, 76, 54,	119,	107, 73,	11,	66,	113,	59,	80, 109, 75, 86, 37, 60,	46}, 		 	  	 
 	{49, 64, 124,	

78,	95, 84,	110, 
59, 
112, 101, 105,	55, 104, 13,	86, 
11,	44,	66, 115, 54, 75, 111,	
107,	48},    	
 	

{120, 
62,	35, 13, 74, 56, 12, 69,	50,	58, 96,	93,	63,	77,	102,	108, 80, 119, 57, 42, 72,	48, 73,	44},	 	  	 

  {37,	71, 
70, 
82,	11,	47,	44, 
54,	

108, 67, 113,	115, 69, 118, 72, 51, 117, 106, 42, 58, 110,	77, 100, 101}, 		     		  				    		
 
 
{78,	82, 48,	83, 121, 
64,	
79, 95, 
56, 
94,	84, 57, 53, 43, 61, 33, 101, 71, 115, 98,	44, 75, 105, 126},		     		  				    		

  {59,	55, 34, 
88, 


83,	

122, 12, 46,	39, 120, 65, 125, 108, 118, 111, 79, 52, 113,	42, 45, 89, 101,	78, 66},			 		  	 			   
 
 {59,	12,	35,	124, 
69, 
112,	115, 106,	97,	71, 
70,	
110, 95, 41, 32, 119, 84,	
86,	91, 120, 92, 
113, 
102,	88},         	   	 			 		  	 			   

  {36,	70,	99, 
121, 

97, 


86,	




43, 91, 120, 114, 53, 60, 56, 62, 52, 54, 79, 117, 106, 12, 66, 122, 45, 67},
		{40, 120, 45, 9, 105, 91, 74, 82, 80, 94, 113, 93, 50, 101, 111, 115, 49, 96, 98, 117, 84, 126, 102, 107}
    };

    for (int i = 0; i < 25; i++) {
        flag[i] = vectors[0][i];
    }

    for (size_t i = 1; i < sizeof(vectors)/sizeof(vectors[0]); i++) {
        xorstr(flag, vectors[i], flag);
    }
}


void print_flag() {
    int flag[24];
    get_flag(flag);
    for (int i = 0; i < 24; i++) {
        printf("%c", (char) flag[i]);
    }
    printf("\n");
}


void print_failure() {
    printf("wro n g	pas sword	!\n");
}


int main(int argc, char *argv[]) {
    if (check_password(get_password()))
        print_flag();
    else
        print_failure();

    return 0x1337;
}
